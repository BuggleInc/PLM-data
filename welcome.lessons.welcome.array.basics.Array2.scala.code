override def run() {
  // On definit le tableau qu'on utilise et sa taille
  var longueurT:Int = getWorldHeight()
  var T = new Array[Color](longueurT)
  
  //On parcoure le monde
  for (i <- 1 to longueurT){
  	for (j <- 1 to longueurT){
      
  	//Dans la 1ere colonne on remplit le tableau
  		if (i==1){
        T(j-1) = getGroundColor()
        if(!isFacingWall)
        	forward()
      }
  
  	//Puis on colorie dans les autres colonnes
      else {
        //On lit le message dans la premi?re cellule
        var offset = 0
        if (j==1){
          offset = readMessage().toInt
        }
        var indice = (j+offset-1)%longueurT
        setBrushColor(T(indice))
        paint()
        if(!isFacingWall)
        	forward()
        
      }
      
    }
    //On remonte et on change de colonne si on peut
    backward(longueurT-1)
    if(i <= longueurT-1)
    	left();forward();right()
  }
  right();forward();left();forward(longueurT-1)
}


def paint(){
  brushDown()
  brushUp()
}