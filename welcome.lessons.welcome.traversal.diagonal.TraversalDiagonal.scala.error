Diagonal:10: error: not found: value doTheDiag
    compt += doTheDiag(compt, diag)
             ^